# Red Team Engagement Report

**Engagement ID:** {{ report.engagement_id }}  
**Target Scope:** {{ report.scope.description }}  
**Generated:** {{ generation_time.strftime('%Y-%m-%d %H:%M:%S') }}  
**Duration:** {{ duration if duration else 'N/A' }}  
**Generated By:** {{ report.generated_by }}  

## Executive Summary

{{ report.executive_summary if report.executive_summary else 'No executive summary provided.' }}

## Methodology

{{ report.methodology if report.methodology else 'Standard red team methodology was followed.' }}

## Statistics

- **Total Findings:** {{ statistics.total_findings }}
- **True Positives:** {{ statistics.true_positives }}
- **False Positives:** {{ statistics.false_positives }}
- **Accuracy:** {{ "%.1f" | format(statistics.accuracy) }}%
- **High Priority Findings:** {{ statistics.high_priority_findings if statistics.high_priority_findings else 0 }}
{% if statistics.avg_confidence %}- **Average Confidence:** {{ "%.1f" | format(statistics.avg_confidence * 100) }}%{% endif %}

## Tools Used

{% for tool in report.tools_used %}
- {{ tool }}
{% endfor %}

## Findings by Severity

{% for severity, findings in findings_by_severity.items() %}
{% if findings %}
### {{ severity.upper() }} ({{ findings|length }})

{% for finding in findings %}
#### {{ finding.title }}

- **Target:** {{ finding.target }}
- **Tool:** {{ finding.tool }}
- **Status:** {{ finding.status.value }}
- **Confidence:** {{ "%.1f" | format(finding.confidence * 100) }}%
{% if finding.cvss_score %}
- **CVSS Score:** {{ finding.cvss_score }}
{% endif %}
{% if finding.cve_id %}
- **CVE ID:** {{ finding.cve_id }}
{% endif %}

**Description:**  
{{ finding.description }}

{% if finding.triage_notes %}
**Triage Notes:**  
{{ finding.triage_notes }}
{% endif %}

{% if finding.remediation %}
**Remediation:**  
{{ finding.remediation }}
{% endif %}

{% if finding.references %}
**References:**
{% for ref in finding.references %}
- {{ ref }}
{% endfor %}
{% endif %}

---

{% endfor %}
{% endif %}
{% endfor %}

## Scan Results Summary

{% for tool, results in scan_summary.items() %}
### {{ tool.upper() }}

- **Status:** {{ results.status }}
- **Findings:** {{ results.findings_count }}
- **Duration:** {{ results.duration if results.duration else 'N/A' }}

{% endfor %}

## Timeline

{% for event in report.timeline %}
- **{{ event.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}:** {{ event.description }}
{% endfor %}

## Recommendations

{% for recommendation in report.recommendations %}
{{ loop.index }}. {{ recommendation }}
{% endfor %}

## AI Analysis Insights

{% if triage_summary %}
### Batch Analysis Results

- **Patterns Detected:** {{ triage_summary.patterns_detected | length }}
- **AI-Detected False Positives:** {{ triage_summary.ai_false_positives }}
- **Analysis Accuracy:** {{ "%.1f" | format(triage_summary.analysis_accuracy * 100) }}%

#### Key Insights
{% for insight in triage_summary.key_insights %}
- {{ insight }}
{% endfor %}

#### Detected Patterns
{% for pattern in triage_summary.patterns_detected %}
- **{{ pattern.type }}:** {{ pattern.description }} ({{ pattern.frequency }} occurrences)
{% endfor %}
{% endif %}

---

*Report generated by Red Team Automation Framework v1.0*  
*Generated at: {{ generation_time.strftime('%Y-%m-%d %H:%M:%S UTC') }}*